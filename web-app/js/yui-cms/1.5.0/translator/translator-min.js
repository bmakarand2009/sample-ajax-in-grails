/*
Copyright (c) 2007, Caridy Patino. All rights reserved.
Portions Copyright (c) 2007, Yahoo!, Inc. All rights reserved.
Code licensed under the BSD License:
http://www.bubbling-library.com/eng/licence
version: 1.5.0
*/
YAHOO.namespace("plugin");
(function(){var $L=YAHOO.lang,$C=YAHOO.util.Connect,$E=YAHOO.util.Event;YAHOO.plugin.Translator=function(){var obj={},_modules={},_uri='/translator.php?',_lang='eng',_charset='UTF-8';var callback={success:function(o){var values=null,m=_modules[o.argument.id].modConfig;try{values=$L.JSON.parse(o.responseText);}catch(e){m.onError.fire();}if(values){obj.set(o.argument.id,values);}},failure:function(o){var m=_modules[o.argument.id].modConfig;m.onError.fire();}};obj.load=function(id,modConfig){var uri,cb,cs;if($L.isString(id)&&(id!=='')){this.reset(id,modConfig);_modules[id].modConfig.ready=false;uri=new String((_modules[id].modConfig.uri)?_modules[id].modConfig.uri:_uri);cs=((_modules[id].modConfig.charset)?_modules[id].modConfig.charset:_charset);if(!uri.indexOf('?')){uri+='?';}else if(uri.indexOf('?')!==uri.length-1){uri+='&';}uri+='lang='+_lang+'&module='+id+'&charset='+cs;cb={success:callback.success,failure:callback.failure,argument:{id:id,module:modConfig}};_modules[id].handle=$C.asyncRequest('GET',uri,cb);}};obj.set=function(id,values){if(!$L.isObject(_modules[id])){this.reset(id);_modules[id].modConfig.name=id;}_modules[id].values=values;_modules[id].modConfig.ready=true;_modules[id].modConfig.onReady.fire();return _modules[id].values;};obj.get=function(id,c,config){config=config||{};config.autoloader=config.autoloader||true;if($L.isObject(_modules[id])){if(this.isReady(id)){if($L.isString(_modules[id].values[c])){return _modules[id].values[c];}else{if($L.isFunction(config.onNull)){config.onNull.apply(_modules[id],[id,c]);}return c;}}else{if($L.isFunction(config.onReady)){_modules[id].modConfig.onReady.subscribe(config.onReady);}if($L.isFunction(config.onError)){_modules[id].modConfig.onError.subscribe(config.onError);}}}else if(config.autoloader){this.load(id,config);}return null;};obj.find=function(c){var r;for(id in _modules){if(_modules.hasOwnProperty(id)){r=this.get(id,c,false);if(r){return r;}}}return null;};obj.add=function(id,values,modConfig){modConfig=($L.isObject(modConfig)?modConfig:{});this.reset(id,modConfig);_modules[id].modConfig.ready=false;_modules[id].modConfig.name=id;return this.set(id,values);};obj.reload=function(){for(id in _modules){if(_modules.hasOwnProperty(id)){this.reset(id,_modules[id].modConfig);this.load(id,_modules[id].modConfig);}}};obj.reset=function(id,modConfig){var onReady,onError;if($L.isString(id)&&(id!=='')){modConfig=modConfig||{};if($L.isObject(_modules[id])){modConfig=_modules[id].modConfig;}else{onReady=new YAHOO.util.CustomEvent('onReady');onError=new YAHOO.util.CustomEvent('onError');if($L.isFunction(modConfig.onReady)){onReady.subscribe(modConfig.onReady);}if($L.isFunction(modConfig.onError)){onError.subscribe(modConfig.onError);}modConfig.onReady=onReady;modConfig.onError=onError;}_modules[id]={modConfig:modConfig};}else{for(id in _modules){if(_modules.hasOwnProperty(id)){this.reset(id,modConfig);}}}};obj.init=function(userConfig){_lang=userConfig.lang||_lang;_uri=userConfig.uri||_uri;_charset=userConfig.charset||_charset;if(!userConfig.silence){this.reload();}};obj.getLang=function(){return _lang;};obj.isReady=function(id){if($L.isObject(_modules[id])){return _modules[id].modConfig.ready;}return false;};return obj;}();})();String.prototype.translate=function(mod){if(YAHOO.lang.isString(mod)&&(mod!=='')){return YAHOO.util.Translator.get(mod,this);}else{return YAHOO.util.Translator.find(this)||this;}};
YAHOO.util.Translator=YAHOO.plugin.Translator;
YAHOO.register("translator",YAHOO.plugin.Translator,{version:"1.5.0",build:"206"});